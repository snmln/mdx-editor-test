import { useState } from 'react';
import { Meta, Story, Canvas, ArgsTable } from '@storybook/addon-docs';

import { DevseedUiThemeProvider } from '@devseed-ui/theme-provider';
import { Button } from '@devseed-ui/button';

import { CollecticonBrandDevelopmentSeed, CollecticonBrandCollecticons } from '.';
import { IconsShowcase } from './story-showcase';
import { IconsDataUri } from './story-data-uri';

<Meta title="Components/Collecticons" />

# Collecticons

This modules allows you to use [collecticons](http://collecticons.io/) svg icons with the UI Library.

```
yarn add @devseed-ui/collecticons
```

<Canvas>
  <Story
    name="Single Collecticon"
    argTypes={{
      color: {
        name: 'color',
        type: { name: 'string', required: false },
        description:
          'Sets the collecticon color. By default inherits from the parent',
        table: {
          type: { summary: 'string' },
          defaultValue: { summary: 'currentColor' },
        },
        control: {
          type: 'text',
        },
        defaultValue: 'currentColor',
      },
      size: {
        name: 'size',
        type: { name: 'string', required: false },
        description: 'Sets the collecticon size',
        table: {
          type: {
            summary: 'string | number',
            detail: 'It is also possible to pass a numeric size. When using a number the value must be in pixels.',
          },
          defaultValue: { summary: 'medium' },
        },
        control: {
          type: 'select',
        },
        options: ['small', 'medium', 'large', 'xlarge', 'xxlarge'],
        defaultValue: 'xxlarge',
      },
      title: {
        name: 'title',
        type: { name: 'string', required: false },
        description:
          'Descriptive title of the svg printed inside it. Required if `meneaningful` is true',
        table: {
          type: { summary: 'string' },
        },
        control: {
          type: 'text',
        },
      },
      meaningful: {
        name: 'meaningful',
        type: { name: 'boolean', required: false },
        description:
          'Defines whether the icon has semantic meaning by setting the property of `aria-hidden`. When an icon is meaningful, a title property should be provided.',
        table: {
          type: { summary: 'boolean' },
          defaultValue: { summary: 'false' },
        },
        control: {
          type: 'boolean',
        },
        defaultValue: false,
      },
    }}
  >
    {args => <CollecticonBrandDevelopmentSeed {...args} />}
  </Story>
</Canvas>

<ArgsTable story="Single Collecticon" />

Some components use collecticons directly and you don't have to do anything.
Others, like the [Button](/button) allow you to add an icon as the content.

<Canvas>
  <DevseedUiThemeProvider>
    <Button
      variation="primary-fill"
      size="small"
      title="Sample button"
      onClick={() => {}}
    >
      <CollecticonBrandCollecticons /> Click Me
    </Button>
  </DevseedUiThemeProvider>
</Canvas>

An icon can also be used directly as a normal `SVG` element, using props to customize its appearance.

<Canvas>
  <DevseedUiThemeProvider>
    Here's some text and an icon <CollecticonBrandCollecticons size="large" color="teal" />
  </DevseedUiThemeProvider>
</Canvas>

## Decorative vs Meaningful icons
By default the collecticons are considered to be decorative elements (using `aria-hidden="true"`), but it is possible to give them semantic meaning by passing a descriptive `title` prop and defining them as `meaningful`.

```jsx
  <CollecticonBrandCollecticons title="The logo of the collecticons icon library" meaningful />
```

export const showcaseControls = {
  color: {
    name: 'color',
    type: { name: 'string', required: false },
    description: 'Story control only. Not a real prop.',
    control: {
      type: 'select',
    },
    options: ['base', 'primary', 'secondary', 'success', 'danger'],
    defaultValue: 'base',
  },
  size: {
    name: 'size',
    type: { name: 'string', required: false },
    description: 'Story control only. Not a real prop.',
    control: {
      type: 'select',
    },
    options: ['small', 'medium', 'large', 'xlarge', 'xxlarge'],
    defaultValue: 'medium',
  },
}

## Data Uri

There are some cases when using an svg icon is not an option. One example is when the icons needs to be used as the `src` of an image.
For these cases there is the `iconDataURI(Icon, props)` function which will convert an icon to its data string representation:
```jsx
  <img src={iconDataURI(CollecticonBrandCollecticons, { size: 'large', color: 'teal' })} />
```

This will also allow the usage of collections as background images of pseudo elements:
```js
const Icon = styled.div`
  &::before {
    display: inline-block;
    content: '';
    background-image: url('${iconDataURI(CollecticonBrandCollecticons, { color: 'white' })}');
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
    width: 1rem;
    height: 1rem;
  }
`;
```

**Important:** When using background images in pseudo elements, the size must be set through `background-size`. Passing a `size` attribute to `iconDataURL` will not have any effect.

<Canvas>
  <Story
    name="Data URI"
    parameters={{
      docs: {
        source: {
          code: 'iconDataURI(Icon, props)'
        },
      },
    }}
    argTypes={showcaseControls}
  >
    {args => <IconsDataUri {...args} />}
  </Story>
</Canvas>

<ArgsTable story="Data URI" />


# Showcase

<Canvas>
  <Story
    name="Showcase"
    parameters={{
      docs: {
        source: {
          code: 'N/A'
        },
      },
    }}
    argTypes={showcaseControls}
  >
    {args => <IconsShowcase {...args} />}
  </Story>
</Canvas>

<ArgsTable story="Showcase" />


# Creating custom icons (advanced)
Collecticons has an extensive selection of icons, but sometimes a project needs custom icons that are not (yet) available in the library.  

These custom icons should be created the in same way collecticons are to ensure the correct interoperability between the different components where they're used.  
By design, Collections only have one color which is then controlled via props, so it is important that the constituents of the SVG don't have a `fill`.  

A collecticon can be created using the function `createCollecticon` which should return a React Component and has the following signature:
```js
createCollecticon((props) => {});

// props = {
//  width: number;
//  height: number;
//  fill: string;
//  xmlns: string;
//  role: 'img';
//  viewBox: '0 0 16 16';
//  'aria-hidden': boolean;
//}
```

The `props` should be spread directly onto the SVG as they'll change depending on the props passed to the Collecticons itself.
The `viewBox` is the only prop that should be set on icon creation if the icon was designed in a different way.
For accessibility purposes, the SVG should have a `<title>` which has a default descriptive title, but also accepts a custom one provided by a prop.

Last, but not least, the returned component should be converted to a styled component.

**Example**  
The following SVG icon:
```xml
<?xml version="1.0" encoding="utf-8"?>
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16" viewBox="0 0 16 16">
  <rect x="2" y="2" width="12" height="12" />
</svg>
```

Would be converted to a Collecticon as:
```jsx
const CollecticonSquare = styled(
  createCollecticon(props => (
    <svg {...props}>
      <title>{props.title || 'A square icon'}</title>
      <rect x="2" y="2" width="12" height="12" />
    </svg>
  )),
)`
  /* icons must be styled-components */
`;

```